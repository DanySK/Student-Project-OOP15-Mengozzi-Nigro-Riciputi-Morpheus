package morpheus.view;

import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;

import javax.imageio.ImageIO;
import morpheus.Morpheus;

/**
 * 
 * This class includes the management of textures and sprites 
 * allow the memory load by loading only once a texture required multiple times
 * 
 * @author Luca Mengozzi		 
 * 
 */
public class Texture {

	/**
	 * 
	 * Map useful for storing texture inside
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	private final static Map<String, TextureManager> texMap = new HashMap<>();
	private TextureManager manager;
	
	/**
	 * 
	 * Costructor of texture that takes as input the path of it
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	public Texture(String fileName) {

		//Cerco la texture nella mappa
		TextureManager oldTexture = texMap.get(fileName);
		//Se è già presente
		if (oldTexture != null) {

			manager = oldTexture;
			//Se non è presente la aggiungo alla mappa
		} else {

			try {

				System.out.println("loading textures: " + fileName);
				//Carico le Texture ex novo dalle risorse
				final URL url = Morpheus.class.getResource(fileName);
				manager = new TextureManager(ImageIO.read(new File(url.toString())));
				texMap.put(fileName, manager);
			} catch (IOException e) {

				e.printStackTrace();
			}
		}

	}

	/**
	 * 
	 * Classic render method
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	public void render(Graphics2D g, double x, double y) {

		g.drawImage(manager.getImage(), (int) x, (int) y, null);
	}

	/**
	 * 
	 * Return the image
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	public BufferedImage getImage() {

		return manager.getImage();
	}

	/**
	 * 
	 * Return the width of the texture
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	public int getWidth() {

		return manager.getWidth();
	}

	/**
	 * 
	 * Return the height of the texture
	 * 
	 * @author Luca Mengozzi		 
	 * 
	 */
	public int getHeight() {

		return manager.getHeight();
	}

}
